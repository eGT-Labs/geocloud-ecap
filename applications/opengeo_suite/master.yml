<%
$bastion_name="bastion" if !$bastion_name
$region = "us-east-1" if !$region
$appname="opengeosuite" if !$appname
$vpc_name = "vpc" if !$vpc_name
$azs = listAZs
# Now remove an invalid AZ if any specified
puts "azs starts as #{$azs}"
$azs.each do |raz|
  puts "==looking at #{raz}=="
  if raz==$azskip then
        puts "==Skipping #{raz} =="
        $azs.delete(raz)
  end

  puts "azs is now #{$azs} "
end
%>

appname: <%= $appname %>
region: <%= $region %>
<% if !$deploy_id then %>
vpcs:
<%= include("vpc.yml") %>
servers:
<%= include("bastion.yml") %>
<% end %>
loadbalancers:
<%= include("lb.yml") %>
server_pools:
<%= include("pool.yml") %>
firewall_rules:
<%= include("sgs.yml") %>
