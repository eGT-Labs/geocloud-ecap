<%
# set up defaults
$bastion_name="bastion" if !$bastion_name
$nat_ssh_user="root" if !$nat_ssh_user
$region = "us-east-1" if !$region
$appname="geonode" if !$appname
$vpc_name = $appname+"-vpc" if !$vpc_name
#puts $bastion_name, $nat_ssh_user, $region, $appname, $vpc_name,$deploy_id
%>
---
appname: "<%=$appname%>"
region: "<%= $region %>"
<% if !$deploy_id then %>
vpcs:
<%= ECAP::Config.include("vpc.yaml") %>
<% end %>
<% if !$deploy_id then %>
servers:
<%= ECAP::Config.include("bastion.yaml") %>
<% end %>
# could put other nonconditional servers here
loadbalancers:
<%= ECAP::Config.include("geonode-lb.yaml") %>
server_pools:
<%= ECAP::Config.include("geonode-pool.yaml") %>
firewall_rules:
<%= ECAP::Config.include("geonode-security_groups.yaml") %>
