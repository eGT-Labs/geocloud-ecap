- name: "geonode-pool"
  min-size: 1
  max-size: 1
  loadbalancers: 
  - concurrent-load-balancer: "geonode-lb"
  add_firewall_rules: 
  - rule_name: "geonode_secgroup"
  vpc: 
    vpc_name: "<%=$appname%>-vpc"
    subnets: 
    - subnet_name: "Private1"
    nat_host_name: "bastion"
    nat_ssh_user: "root"
  run_list: 
  - "role[geonode]"
  dependencies: 
  - name: "geonode-lb"
    type: "loadbalancer"
  - name: "bastion"
    type: "server"
    phase: "deploy"
  basis: 
    launch-config: 
      name: "geonode-launch"
      size: "t2.medium"
      iam-role: "CAP-node"
      <%= ECAP::Config.include("../hardened-ubuntu-14-ami-#{$region}.yaml") %>
