- name: "geonode-pool"
  min-size: 1
  max-size: 1
  ssh_user: "ubuntu"
  loadbalancers: 
  - concurrent-load-balancer: "geonode-lb"
  add_firewall_rules: 
    - rule_name: "geonode_secgroup"
  vpc:
   vpc_name: "<%=$vpc_name %>"
   <% if $deploy_id %>
   deploy_id: "<%=$deploy_id %>"
   <% end %>
   subnets:
   - subnet_name: "Private1"
   nat_host_name: "<%=$bastion_name %>"
   nat_ssh_user: "root"
  run_list: 
  - "role[geonode]"
  dependencies: 
  - name: "geonode-lb"
    type: "loadbalancer"
  <% if !$vpc_name %>
  - name: "<%=$bastion_name %>"
    type: "server"
    phase: "deploy"
  <% end %>
  basis: 
    launch-config: 
      name: "geonode-launch"
      size: "t2.medium"
      iam-role: "ecap_node_role"
      <%= ECAP::Config.include("../hardened-ubuntu-14-ami-#{$region}.yaml") %>
